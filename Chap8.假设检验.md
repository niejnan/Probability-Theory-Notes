## Chap8.假设检验

### 59.假设检验

统计推断包含两个基本能问题：

第一个是估计问题，包括点估计和区间估计

第二个就是假设检验问题：提出相关假设，根据样本做判断



假设检验也分为两大类问题：

1. 参数检验：总体分布已知，检验关于未知参数
2. 非参数检验：不是对总体参数的假设



例如，假设总体服从泊松分布----非参数检验

例如，已知总体 $X\sim N(\mu,\sigma^2)$，假设参数 $\mu=50$-----参数检验



假设检验的基本原理：**实际推断原理**

**小概率事件在一次试验中几乎不可能发生**



根据统计推断原理，对于一个假设检验问题，借助某个统计量来构造一个事件 $A$，使在某假设 $H_0$ 为真的条件下，它发生的概率很小，若 $H_0$ 不真实时，$A$ 发生的概率显著地变化。

然后根据数据样本观察值来得知这个小概率事件是否发生了，如果已经发生了，就拒绝 $H_0$；如果没有发生，就接受 $H_0$。



构造一个假设 $H_0$，假设其为真------>构造统计量(检验统计量)------>A 发生概率很小




某车间用一台包装机包装葡萄糖。袋装糖的净重是一个随机变量，服从正态分布 $X \sim N(\mu, \sigma^2)$，当机器正常时，其值为 0.5kg，标准差为 0.015kg。某日开工后检验包装是否正常，随机地抽取了 9 个包装袋，得到每袋糖的重量（kg）：0.497 0.506 0.518 0.524 0.498，0.511 0.520 0.515 0.512，问机器是否正常？


对此类检验问题，首先提出假设：

- 机器正常：$H_0: \mu = 0.5$，称为原假设；
- 机器不正常：$H_1: \mu \neq 0.5$，称为备择假设。

**两类错误：**但是，根据上述 9 个有限的样本值做出 $H_0$​ 是否成立的判断永远不可能避免地发生如下两类错误：

- 第一类错误：$H_0$ 为真，拒绝 $H_0$，称为弃真错误；
- 第二类错误：$H_0$ 为假，接受 $H_0$，称为取伪错误。



显著性检验：既然上述错误无法排除，我们只能控制发生错误的概率，这里只考虑控制第一类错误的概率，即显著性检验，即：
$$
P\left\{ H_0 \text{为真，拒绝} H_0 \right\} \leq \alpha
$$
$\alpha$ 称为显著性水平。



因为 $\overline{X}$ 是 $\mu$ 的无偏估计，若 $H_0$ 为真，此时 $|\overline{X} - 0.5|$ 应该较小。因此在 $H_0$ 为真的条件下，拒绝 $H_0$ 应满足 $|\overline{X} - 0.5|$ 较大，又 $H_0$ 为真的条件下：
$$
Z = \frac{\overline{X} - 0.5}{\sigma/\sqrt{n}} \sim N(0, 1)
$$
此处的 $Z$ 称为检验统计量。

可以认为当 $|\overline{X} - 0.5|$ 较大（小概率事件发生）时，可作出拒绝 $H_0$ 的结论，即拒绝 $H_0$，而常数 $k$ 由
$$
P\left\{ |\overline{X} - 0.5| > k \right\} = \alpha
$$
可得 $k = Z_{\alpha/2}$。

故当统计量的观察值满足 $|z| = \frac{|\overline{X} - 0.5|}{\sigma/\sqrt{n}} > Z_{\alpha/2}$ 时，拒绝 $H_0$。

当统计量的观察值满足 $|z| = \frac{|\overline{X} - 0.5|}{\sigma/\sqrt{n}} < Z_{\alpha/2}$ 时，接受 $H_0$。

称 $W = \left\{ \frac{|\overline{X} - 0.5|}{\sigma/\sqrt{n}} > Z_{\alpha/2} \right\}$ 为拒绝域。

拒绝域的边界点 $-Z_{\alpha/2}, Z_{\alpha/2}$ 称为临界点。



**假设检验的步骤和方法**

1. **根据实际问题的要求，提出原假设与备择假设**；
2. **根据假设和题目条件确定检验统计量，并在 $H_0$ 成立的条件下确定其分布**；
3. **给定显著水平 $\alpha$，在 $H_0$ 成立的条件下根据数据计算检验统计量，得到 $P\left( H_0 \text{为真，拒绝} H_0 \right) \leq \alpha$，确定拒绝域与临界点**；
4. **由样本值计算检验统计量值，若该值落入拒绝域，则拒绝 $H_0$，否则接受 $H_0$**。



### 60.假设检验的基本概念

**假设检验问题的描述**

在显著性水平 $\alpha$ 下，检验假设：

$H_0: \mu = \mu_0$，$H_1: \mu \neq \mu_0$  

$H_0$ 称为原假设或零假设；  

$H_1$​ 称为备择假设（在原假设被拒绝后提供选择的假设）。



任务：根据样本，利用上述检验方法在 $H_0$ 和 $H_1$ 之间选择一个。



**原假设和备择假设选择原则：**

1. **应当使大多数人普遍认为它成立的命题作为原假设**。  

   因为原假设不能轻易拒绝，除非有足够的证据证明它不对。  

   **例如**：说“跑步有益健康”，想知道这是否是真的，因为这是常识，所以应把“跑步有益健康”作为原假设。

2. **应当把分析人员想证明它不正确的命题作为原假设**，  

   把分析人员想证明它正确的命题作为备择假设。  

   **例如**：据说有种新方法能改善生产效率，我们想知道这是否是真的。我们希望这是事实的，并努力证明这是事实，所以应把“新方法能改善生产效率”作为备择假设。





**检验统计量：**

根据假设和题目条件确定一个统计量，并在 $H_0$ 成立的条件下确定其分布，此统计量称为检验统计量



**拒绝域，临界点**  
当检验统计量取某个区间 $C$ 中的值时，我们拒绝原假设 $H_0$，则称区间 $C$ 为拒绝域。  

拒绝域的边界点称为临界点。



**显著性检验**  

根据有限的样本值做出 $H_0$​ 是否成立的判断永远不可避免地发生以下两类错误：

- 第一类错误：拒绝错误的原假设 $H_0$ 为真，称为**假阳性**错误。
- 第二类错误：取侥幸错误的 $H_0$ 为假，接受 $H_0$，称为**假阴性**错误。

既然上述错误无法排除，我们只能控制发生错误的概率，这里只考虑控制第一类错误的概率，即**显著性检验**，其概念为：
$$
P\left\{ H_0 \text{为真，拒绝} H_0 \right\} \leq \alpha
$$
**假设检验的分类**  

- 双边检验：$H_0: \mu = \mu_0$, $H_1: \mu \neq \mu_0$  
- 右边检验：$H_0: \mu \leq \mu_0$, $H_1: \mu > \mu_0$  
- 左边检验：$H_0: \mu \geq \mu_0$, $H_1: \mu < \mu_0$





#### 单边检验的拒绝域

设总体服从正态分布 $X \sim N(\mu,\sigma^2)$ ，均值未知，方差已知。

$X_1,X_2,.....,X_n$ 是来自总体 $X$ 的样本，给定显著性水平 $\alpha$，求检验问题：
$$
H_0:\mu\leq\mu_0,H_1:\mu>\mu_0
$$
的拒绝域。



#### exp：

公司从生产商购买牛奶。公司怀疑生产商在牛奶中掺水以谋利。通过测定牛奶的冰点，可以检验出牛奶是否掺水。天然牛奶的冰点温度近似服从正态分布，均值 $\mu_0 = -0.545^\circ C$，标准差 $\sigma = 0.008^\circ C$。牛奶掺水可使冰点温度升高而接近于水的冰点温度（0°C）。测得生产商提供的 5 批牛奶的冰点温度，均值为 $\overline{x} = -0.535^\circ C$，问是否可以认为生产商在牛奶中掺了水？取 $\alpha = 0.05$。


在显著性水平 $\alpha = 0.05$ 下，检验假设

- 原假设：$H_0: \mu = -0.545$；
- 备择假设：$H_1: \mu > -0.545$（认为掺水）。


检验统计量为：
$$
Z = \frac{\overline{x} - \mu_0}{\sigma/\sqrt{n}} \sim N(0, 1)
$$
拒绝域为：
$$
Z = \frac{\overline{x} - \mu_0}{\sigma/\sqrt{n}} > Z_{\alpha} = Z_{0.05}
$$
临界值 $Z_{0.05} = 1.645$；  
样本量 $n = 5$，样本均值 $\overline{x} = -0.535$，标准差 $\sigma = 0.008$。



代入计算得：
$$
Z = \frac{-0.535 - (-0.545)}{0.008/\sqrt{5}} = \frac{0.01}{0.008/\sqrt{5}} = 2.7951 \geq 1.645
$$
在显著性水平 $\alpha = 0.05$ 下，拒绝 $H_0$，即认为生产商掺水。



### 61.单个正态总体均值的假设检验

假设检验的过程

**一、方差 $\sigma^2$ 已知，关于均值 $\mu$ 的 $Z$ 检验**

假设总体 $X \sim N(\mu, \sigma^2)$，$X_1, X_2, ..., X_n$ 是来自总体 $X$ 的样本。

检验：
- $H_0: \mu = \mu_0$，$H_1: \mu \neq \mu_0$
- $H_0: \mu \leq \mu_0$，$H_1: \mu > \mu_0$

检验统计量：
$$
Z = \frac{\overline{X} - \mu_0}{\sigma/\sqrt{n}} \sim N(0,1)
$$

拒绝域：
$$
Z = \frac{\overline{X} - \mu_0}{\sigma/\sqrt{n}} > Z_\alpha
$$
临界值为 $Z_{\alpha/2}$。



**二、方差 $\sigma^2$ 未知，关于均值 $\mu$ 的 $t$ 检验**

假设总体 $X \sim N(\mu, \sigma^2)$，$\mu$，$\sigma^2$ 未知。

在显著性水平 $\alpha$ 下，求检验问题 $H_0: \mu = \mu_0$，$H_1: \mu \neq \mu_0$ 的拒绝域。

##### 解决：
1. 检验统计量：
   $$ t = \frac{\overline{X} - \mu_0}{S/\sqrt{n}} \sim t(n-1) $$

2. 拒绝域：
   - 若 $H_0$ 为真，$| \overline{X} - \mu_0 |$ 较小；
   - 若 $|\overline{X} - \mu_0|$ 过大，拒绝 $H_0$。

拒绝域的形式为：
$$
|t| = \left| \frac{\overline{X} - \mu_0}{S/\sqrt{n}} \right| \geq Z_\alpha
$$

确定常数：
$$
P\left\{ H_0 \text{ 被拒绝} \right\} = \alpha
$$
检验统计量：
$$
t = \frac{\overline{X} - \mu_0}{S/\sqrt{n}} \sim t(n-1)
$$
取 $k = t_{\alpha}(n-1)$，放弃拒绝域为：

$$
 |t| = \frac{|\overline{X} - \mu_0|}{S/\sqrt{n}} > t_{\alpha}(n-1) 
$$
注：

① $\sigma^2$ 已知时，对 $\mu$ 的均值检验结果。

② 用 $t$ 统计量得出的拒绝域→$t$ 检验法。



### 62.两个正态总体均值差的假设检验



### 63.单个正态总体方差的假设检验



### 64.两个正态总体方差的假设检验

