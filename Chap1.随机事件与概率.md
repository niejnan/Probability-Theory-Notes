## 概率论与数理统计



##### 样本空间：

随机试验所有可能结果组成的几何，称为样本空间，记作 $S$，或者 $\Omega$

##### 样本点：

随机试验每一个可能的结果称为样本点，记为 $e$

样本空间 $S$，是由全部样本点构成的集合。$S={e}$



即使样本相同，试验的目的不同的样本空间也不一样。

- 抛硬币，观察正反出现的情况，$S={H,T}$
- 抛硬币三次，观察正反面出现的情况，$S={HHH,HHT.....}$

- 将硬币抛三次，观察出现正面 $H$ 的次数，$S={0,1,2,3}$

求随机试验的样本空间，方法1：列举法(有限个) 方法2：描述法(无穷多个)



##### 随机事件

样本空间 $S$ 的子集称为 $E$ 的随机事件，用 $A,B$ 表示

##### 事件发生

在每次实验中，当且仅当随机事件中的一个样本点出现，称为这个事件发生

##### 基本事件

由一个样本点组成的单点集，称为基本事件



##### 必然事件

样本空间 $S$ 包含了所有的样本点，在每次实验中它总发生，故称为必然事件。

##### 不可能事件

空集不包含任何的样本点，在每次实验中都不发生，称为不可能事件

##### 随机事件



#### 5.事件关系运算

![截屏2025-02-18 20.44.31](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-18 20.44.31.png)

在一次试验中，基本事件是两两互不相容的。



![截屏2025-02-18 20.46.17](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-18 20.46.17.png)

并：若 $A+B$ 发生了，那么两个事件 $A,B$ 至少有一个发生。

交：若 $AB$ 发生，只有 $AB$ 同时发生，才可能发生

差：$A-B$ 当事件 $A$ 发生时候，且 $B$ 不发生， $A-B$ 发生。



事件的运算法则和集合的运算法则基本一致，但从“事件发生”的角度解释

![截屏2025-02-18 20.51.10](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-18 20.51.10.png)

$A+B$ 是 $A,B$ 至少有一个发生，它的逆事件是，$A$ 的逆 交 $B$ 的逆，

$AB$ 同时发生的逆事件是 $A$ 的逆事件和 $B$ 的逆事件至少有一个发生。



可以讲一个事件，表示为与它相等的形式，便于计算



#### 6.频率与概率

概率的公理化定义：

设 $E$ 是随机试验， $S$ 是他的样本空间，对于 $E$ 的每一个事件 $A$ 赋一个实数，记为 $P(A)$，如果集合函数 $P()$ 满足下列条件：

1. 非负性：$P(A)\geq0$
2. 规范性：对必然事件 $S$，$P(S)=1$
3. 可列可加性：设 $A_1,A_2,....$ 是两两互不相容的事件，即：$A_iA_j$ 为空集，有 $P(A_1+A_2+...)=P(A_1)+P(A_2)+...$



性质1：空集的概率为0

性质2：有限可加性，设 $A_1,A_2,...A_n$

性质3：减法公式，$P(A-B)=P(A)-P(AB)$

性质4：单调性，若 B 包含于 A，则 $P(A-B)=P(A)-P(B),P(A)\geq P(B)$

性质5：有界性 $P(A)\leq1$

性质6：加法公式，$P(A+B)=P(A)+P(B)-P(AB)$



#### 7.古典概型

频率只是概率的估计，而非概率本身。



**加法原理**

设完成一件事有 n 类方法（只要选择其中一类方法即可完成这件事），若第一类方法有 m₁ 种，第二类方法有 m₂ 种，…，第 n 类方法有 mₙ 种，则完成这件事共有$N = m₁ + m₂ + ⋯ + mₙ$ 种方法。



**乘法原理**

设完成一件事须有 n 个步骤（仅当 n 个步骤都完成，才能完成这件事），若第一步有 m₁ 种方法，第二步有 m₂ 种方法，…，第 n 步有 mₙ 种方法，则完成这件事共有 $N = m₁ × m₂ × ⋯ × mₙ$ 种方法。



**排列**

从 n 个不同的元素中任取 m (m ≤ n) 个按照一定的顺序排列成一列，称为从 n 个不同的元素中取出 m 个元素的一个排列，从 n 个不同的元素中取出 m 个元素的所有排列种数，记为

$$
P^m_n = n(n-1)(n-2)⋯[n-(m-1)] = \frac{n!}{(n-m)!}
$$

从 n 个不同的元素中全部取出的排列称为全排列，其排列的种数，记为

$$
P_n = n!
$$



**允许重复的排列**

从 n 个不同的元素中有放回地取 m 个按照一定顺序排列成一列，其排列的种数为

$$
N = n \times n \times ⋯ \times n = n^m
$$



**组合**

从 n 个不同的元素中取出 m 个元素，不管其顺序并成一组，称为从 n 个不同的元素中取出 m 个元素的一个组合，其组合总数为

$$
C^m_n = \frac{P^m_n}{m!} = \frac{n!}{m!(n-m)!}
$$




**古典概型的定义**

若随机试验 $E$ 满足：

1. 样本空间 $S$，只包含有限个样本点，$S={e_1,e_2,...,e_n}$
2. 每个基本事件(样本点)发生的可能性相同

则称此随机试验的概率模型为等可能概型，也成为古典概型



#### 8.几何概型

若随机试验 $E$ 满足：

1. 样本空间 $S$ 是 $R^n(n=1,2,3)$ 中一个可度量的几何区域；
2. 每个样本点出现的概率相等，即样本点落入 $S$ 某一可度量的子区域 $A$ 的可能性大小与 $A$ 的几何量成正比，而与 $A$ 的位置及形状无关。



#### 9.条件概率

若已知某个事件发生，如何求另一个事件发生的概率？----条件概率

 $S={HH,HT,TH,TT}$

$A={HH,HT,TH}$

$B={HH,TT}$

$AB={HH}$

已知 $A$ 发生，当前样本空间可以认为是 $A$ ，$B$ 发生，就是 $HH$ 出现

故在 $A$ 发生条件下 $B$ 发生的概率，记为 $P(B \mid A)$

即在 $A$ 发生的条件下考虑 $B$ 发生的概率。



**条件概率的定义**

设 $A,B$ 是两个条件，且 $P(A)>0$，称 $P(B \mid A)=\frac{P(AB)}{P(A)}$ 为事件 $A$ 在发生的条件下事件 $B$ 发生的条件概率。

$P(AB)$ 是在样本空间为 $S$ 的时候，$A,B$ 同时发生的可能性

$P(B\mid A)$ 表示在 $A$ 发生的条件下， $B$ 发生的可能性，此时样本空间已经变为 $A$



**条件概率的性质**

当 $P(A) > 0$ 时，

1. $P(B|A) \geq 0$；
2. $P(S|A) = 1, P(\varnothing|A) = 0$；
3. $P(B \cup C|A) = P(B|A) + P(C|A) - P(BC|A)$；
4. 当 $B, C$ 互不相容时，

$$
P(B \cup C|A) = P(B|A) + P(C|A)
$$

5. $P(B - C|A) = P(B|A) - P(BC|A)$；
6. $P(\overline{B}|A) = 1 - P(B|A)$。



#### 10.乘法公式

$P(AB)=P(A)P(B\mid A)$

这个式子是由条件概率得来的，同样还可以得到 $P(AB)=P(B)P(B\mid A)$



#### 图像卷积、数学卷积

**推广**

(1) 设 $A, B, C$ 为事件，且 $P(AB) > 0$，则有

$$
P(ABC) = P(A)P(B|A)P(C|AB).
$$

证明： 

$$
P(ABC) = P(AB) \cdot P(C|AB)
= P(A) \cdot P(B|A) \cdot P(C|AB).
$$

(2) 设 $A_1, A_2, \dots, A_n$ 为 n 个事件，$n \geq 2$，且 $P(A_1 A_2 \dots A_{n-1}) > 0$，则有

$$
P(A_1 A_2 \dots A_n) = P(A_1)P(A_2|A_1)P(A_3|A_1A_2) \dots P(A_n|A_1 A_2 \dots A_{n-1}).
$$


#### 11.全概率公式、贝叶斯公式

很多实际问题中，$P(A)$ 不容易求，但是容易得到一组两两不互相容且和事件为样本空间，并且知道相关事件概率，则此时就可以求出 $P(A)$

![截屏2025-02-19 09.27.47](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-19 09.27.47.png)

**样本空间的划分**

定义：设 $S$ 为随机试验 $E$ 的样本空间，$B_1, B_2, \dots, B_n$ 为 $E$ 的一组事件。若

1. $B_i B_j = \varnothing (i \neq j, i, j = 1, 2, \dots, n)$；
2. $B_1 \cup B_2 \cup \dots \cup B_n = S$，

则称 $B_1, B_2, \dots, B_n$ 为样本空间 $S$ 的一个划分（或完全事件组）。

**注**：
1. 若 $B_1, B_2, \dots, B_n$ 为样本空间 $S$ 的一个划分，则对每次试验，事件 $B_1, B_2, \dots, B_n$ 中必有一个且仅有一个发生。
2. 样本空间的划分一般不唯一。$S={1,2,3,4,5,6}=B_1={1,3,5}+B_2={2,4,6}$

互不相容，不含有公共的样本点



**全概率公式**

引入：设试验 $E$ 的样本空间为 $S$，$A$ 为 $E$ 的事件，$B_1, B_2, \dots, B_n$ 为 $S$ 的一个划分，且 $P(B_i) > 0 \ (i = 1, 2, \dots, n)$，那么 $P(A) = ?$

由定义，$P(A) = P(A \cap S) = P(A \cap (B_1 \cup B_2 \cup \dots \cup B_n))$

由于 $B_1, B_2, \dots, B_n$ 为划分，故

$$
P(A) = P(A \cap B_1) + P(A \cap B_2) + \dots + P(A \cap B_n)
$$

这等价于：

$$
P(A) = P(B_1) \cdot P(A|B_1) + P(B_2) \cdot P(A|B_2) + \dots + P(B_n) \cdot P(A|B_n)
$$



**定理**：设试验 $E$ 的样本空间为 $S$，$A$ 为 $E$ 的事件，$B_1, B_2, \dots, B_n$ 为 $S$ 的一个划分，且 $P(B_i) > 0 \ (i = 1, 2, \dots, n)$，则
$$
P(A) = P(B_1) \cdot P(A|B_1) + P(B_2) \cdot P(A|B_2) + \dots + P(B_n) \cdot P(A|B_n)
$$

$$
P(A)=\sum_{i=1}^{n}P(B_i)P(A \mid B_i)
$$

注：
1. 若把全概率公式中的 $A$ 视为 “果”，把 $B_1, B_2, \dots, B_n$ 视为 “因”，则全概率公式反应的是 “由因求果” 的概率问题；
2. 应用时首先要对所涉及的事件赋予概率符号；哪些是因？
3. 关键是找到导致事件 $B$ 发生的样本空间的一个划分，完备事件组



**贝叶斯公式**

贝叶斯公式是由全概率公式得来的，问题：$A$ 已经发生， $B_i$ 出现的概率。



**定理**：设 $E$ 的样本空间为 $S$，$A$ 为 $E$ 的事件，$B_1, B_2, \dots, B_n$ 为 $S$ 的一个划分，且 $P(A) > 0, P(B_i) > 0 \ (i = 1, 2, \dots, n)$，则
$$
P(B_i | A) = \frac{P(AB_i)}{P(A)} = \frac{P(B_i) \cdot P(A|B_i)}{\sum_{j=1}^{n} P(B_j) \cdot P(A|B_j)}, \quad i = 1, 2, \dots, n.
$$

**注**：
1. 此公式首先是应用条件概率公式，分母为全概率公式，是 $n$ 项之和，分子是分母中的某一项。贝叶斯公式：由果求因。
2. 形式平淡，但富有哲理，贝叶斯统计应用广泛。

乘法公式分解+全概率公式。

已经结果发生，对于每个原因的概率都可以计算出来。

**在统计学中，往往是依靠收集的数据，去寻找感兴趣的问题的答案，这就是一个由结果找原因的过程。**

 

![截屏2025-02-19 09.49.30](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-19 09.49.30.png)

解：设 A：取到一只次品， $B_i$：所取产品由第 $i$ 家工厂提供，$i=1,2,3$ 

已知：$B_1, B_2, B_3$ 是 $S$ 的一个划分 

$P(B_1) = 0.15, \quad P(B_2) = 0.80, \quad P(B_3) = 0.05$

$P(A|B_1) = 0.02, \quad P(A|B_2) = 0.01, \quad P(A|B_3) = 0.03$ 

(1) “由因求果” 由全概率公式： 
$$
P(A) = P(B_1)P(A|B_1) + P(B_2)P(A|B_2) + P(B_3)P(A|B_3)\\= 0.15 \times 0.02 + 0.80 \times 0.01 + 0.05 \times 0.03= 0.0125
$$
(2) “由果导因” 由贝叶斯公式： 
$$
P(B_1|A) = \frac{P(AB_1)}{P(A)} = \frac{P(B_1)P(A|B_1)}{P(A)} = \frac{0.15 \times 0.02}{0.0125} = 0.24
$$
 
$$
P(B_2|A) = 0.64,P(B_3|A) = 0.12
$$




![截屏2025-02-19 10.09.44](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-19 10.09.44.png)

由果索因，假设 $B_1,B_2$ 为机器良好，$A$ 为产品合格。则：
$$
P(B_1)=0.95\ ,P(B_2)=0.05\ ,P(B_1\mid A)=0.98\ ,P(B_2 \mid A)=0.05
$$

$$
P(A)=P(B)P(A\mid B)+P(B_2)P(B_2\mid A)
$$

由贝叶斯公式：
$$
P(B\mid A)=\frac{P(B)P(A\mid B)}{P(A)}=0.97
$$
**先验概率、后验概率**

$P(B_1)=0.95$，是根据以往的经验分析得到的，是先验概率

$P(B\mid A)=0.97$，是在得到信息，生产出的第一件产品是合格品的条件下得到的，是后验概率





#### 12.独立性

设 $A,B$ 是两事件，若满足 $P(AB)=P(A)P(B)$，则称事件 $A,B$ 相互独立。



1. 两个事件相互独立与互不相容不能同时成立

若独立 $P(AB)=P(A)P(B)>0$，若互不相容，则 $P(AB)=P(\varnothing)=0$

2. 必然事件及不可能事件与任意事件相互独立



定理一： 

设 $ A, B $ 是两事件，且 $ P(A) > 0 $，若 $ A, B $ 相互独立，则 $ P(B|A) = P(B) $，反之亦然。

证明：由 $ A, B $ 独立，知 $ P(AB) = P(A) \cdot P(B) $ ，

而 $ P(B|A) = \frac{P(AB)}{P(A)} = \frac{P(A) \cdot P(B)}{P(A)} = P(B) $. 



定理二：

若事件 $ A $ 与 $ B $ 相互独立，则下列各对事件也相互独立： $ A $ 与 $ \overline{B} $ ， $ \overline{A} $ 与 $ B $ ， $ \overline{A} $ 与 $ \overline{B} $.

也就是说，若 $A,B$ 独立，则 $A,B$ 中任意一个事件换成逆事件后得到的事件组仍然成立。



简单的来说，若 $A,B$ 独立，$A$ 的发生对 $B$ 的发生没有影响
$$
P(AB)=P(A)P(B)\\P(A\mid B)=P(A) \\P(B\mid A)=P(B)
$$


**三事件两两独立**

1. 三事件两两独立：

$$
\begin{cases}
P(AB) = P(A)P(B) \\
P(AC) = P(A)P(C) \\
P(BC) = P(B)P(C)
\end{cases}
$$

则称事件 $A,B,C$ 两两独立

2. 三事件相互独立：
$$
\begin{cases}
P(AB) = P(A)P(B) \\
P(AC) = P(A)P(C) \\
P(BC) = P(B)P(C) \\
P(ABC) = P(A)P(B)P(C)
\end{cases}
$$

则称事件 $A, B, C$ 相互独立.

注：三个事件$A, B, C$ 相互独立 $\Rightarrow$ $A, B, C$ 两两独立，反之不成立.



**$n$ 个事件的独立性**

定义 设 $ A_1, A_2, \cdots, A_n $ 是 $ n (n \geq 2) $ 个事件，如果对于其中任意 2 个，任意 3 个，…，任意 $ n $ 个事件的概率，都等于各事件概率的乘积，则称事件 $ A_1, A_2, \cdots, A_n $ 相互独立



**独立性的判定**

1. 直观判断，根据事件的实际意义去判断。
2. 利用定义和定理，$P(AB)=P(A)P(B)$





![截屏2025-02-19 10.49.29](/Users/n/Library/Application Support/typora-user-images/截屏2025-02-19 10.49.29.png)
$$
P(A)=P(A_1A_2+A_3A_4)
$$

$$
=P(A_1A_2)+P(A_3A_4)-P(A_1A_2A_3A_4) (加法公式)
$$

$$
P(A_1)P(A_2)+P(A_3)P(A_4)-P(A_1)P(A_2)P(A_3)P(A_4)(独立性)
$$









